name: 'Delete Cache'

on:
  pull_request:
    types: [closed]

  workflow_dispatch:
    inputs:
      branch:
        type: string
        required: false
        default: 'main'
        description: >
          The branch to clear cache for.

env:
  branch: ${{ github.event.number || inputs.branch || 'latest' }}

jobs:
  delete:
    runs-on: ubuntu-latest
    steps:
      - uses: snnaplab/delete-branch-cache-action@v1
        with:
          # Specify explicitly because the ref at the time of merging will be a branch name such as 'main', 'develop'
          ref: refs/pull/${{ env.branch }}/merge
